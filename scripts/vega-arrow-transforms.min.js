!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("vega"),require("apache-arrow")):"function"==typeof define&&define.amd?define(["exports","tslib","vega","apache-arrow"],t):t(((e=e||self).vega=e.vega||{},e.vega.transforms=e.vega.transforms||{},e.vega.transforms.arrow={}),e.tslib,e.vega,e.apacheArrow)}(this,(function(e,t,r,a){"use strict";const s=r,i=a;var o=r.Transform,n=a.Table;class d extends o{constructor(e){super([],e),this.type="ArrowTransform"}data(e){return e instanceof n?(this._data=e,this):e instanceof ArrayBuffer?(e=new Uint8Array(e),this._data=n.from(Array.isArray(e)?e:[e]),this):(this._data=n.new(e),this)}transform(e,r){return t.__awaiter(this,void 0,void 0,(function*(){if(!this._data)throw Error("ArrowTransform missing data Table.");if(!r)throw Error("ArrowTransform missing params.");var t,a=r.countBy,s=r.filter,i=r.getColumn,o=r.getColumnAt,n=r.select,d=r.selectAt,f=r.slice;a?t=yield this._data.countBy(a):s?t=yield this._data.filter(s):i?t=yield this._data.getColumn(i):o?t=yield this._data.getColumnAt(o):n?t=yield this._data.select(n):d?t=yield this._data.selectAt(d):f&&(t=yield this._data.slice(f.get("begin"),f.get("end")));const l=e.fork(e.NO_FIELDS&e.NO_SOURCE);return l.rem=this._value,this._value=l.add=l.source=t,l}))}}e.ArrowTransform=d,e.Slice=class{constructor(e,t){this.begin=e,this.end=t}},e.apacheArrow=i,e.register=function(e){"undefined"!==e&&(e.transforms.ArrowFilter=d)},e.vega=s,Object.defineProperty(e,"__esModule",{value:!0})}));