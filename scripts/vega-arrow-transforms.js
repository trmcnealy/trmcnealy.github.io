!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vega-dataflow"),require("apache-arrow")):"function"==typeof define&&define.amd?define(["exports","vega-dataflow","apache-arrow"],t):t(((e=e||self).vega=e.vega||{},e.vega.transforms=e.vega.transforms||{},e.vega.transforms.arrow={}),e.vegaDataflow,e.apacheArrow)}(this,(function(e,t,a){"use strict";var n=window&&window.__awaiter||function(e,t,a,n){return new(a||(a=Promise))((function(r,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))};class r extends t.Transform{constructor(e){super([],e),this._dataTable=null,this._definition=null,t.definition({type:"ArrowTransform",metadata:{changes:!0,source:!0},params:[{name:"filter",type:"Predicate"},{name:"getColumn",type:"field"},{name:"getColumnAt",type:"number"},{name:"select",type:"field",array:!0},{name:"selectAt",type:"number",array:!0},{name:"slice",type:"param",params:[{name:"begin",type:"number"},{name:"end",type:"number"}]}]})}get Table(){return this._dataTable}set Table(e){e instanceof a.Table&&(this._dataTable=e),e instanceof ArrayBuffer&&(e=new Uint8Array(e),this._dataTable=a.Table.from(Array.isArray(e)?e:[e])),this._dataTable=a.Table.new(e)}get Definition(){return this._definition}set Definition(e){this._definition=e}transform(e,a){return n(this,void 0,void 0,(function*(){if(!this._dataTable)throw Error("ArrowTransform missing data Table.");const n=a.fork(a.NO_FIELDS&a.NO_SOURCE);let r=e.filter,i=e.getColumn,s=e.getColumnAt,o=e.select,l=e.selectAt,d=e.slice,f=null;return r?f=yield this._dataTable.filter(r):i?f=yield this._dataTable.getColumn(i):s?f=yield this._dataTable.getColumnAt(s):o?f=yield this._dataTable.select(o):l?f=yield this._dataTable.selectAt(l):d&&(f=yield this._dataTable.slice(d.get("begin"),d.get("end"))),f.forEach(t.ingest),n.rem=t.Transform.value,t.Transform.value=n.add=n.source=f,n}))}}e.Slice=class{constructor(e,t){this._begin=0,this._end=0,this._begin=e,this._end=t}get begin(){return this._begin}set begin(e){this._begin=e}get end(){return this._end}set end(e){this._end=e}},e.register=function(e){"undefined"===e||e.transforms.ArrowFilter||(e.transforms.ArrowFilter=r)},Object.defineProperty(e,"__esModule",{value:!0})}));